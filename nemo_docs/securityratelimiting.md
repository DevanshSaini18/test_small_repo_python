## Security & Rate Limiting

This section documents the platform's security primitives, authentication flows, RBAC enforcement, webhook signing, and rate limiting configuration.

### Authentication
- JWT-based user auth
  - Tokens are issued and validated in app/auth.py (create_access_token, decode_access_token). Tokens include an exp claim; default expiry is 24 hours (ACCESS_TOKEN_EXPIRE_MINUTES). SECRET_KEY and ALGORITHM drive signing.
  - Passwords are hashed/verified via passlib bcrypt (pwd_context) in app/auth.py (get_password_hash, verify_password).
  - Token subject (`sub`) maps to User.id and is resolved by the get_current_user dependency (app/dependencies.py).
- API keys
  - Secure API keys are generated by generate_api_key() in app/auth.py (sk_ prefix + token_urlsafe).
  - API clients supply keys via the X-API-Key header. Verification is implemented in verify_api_key (app/dependencies.py): checks key value, is_active, expiration, updates last_used_at and resolves the associated Organization.

### Role-Based Access Control (RBAC)
- Roles (Owner, Admin, Member, Viewer) are enforced by the require_role dependency in app/dependencies.py. It uses a role_hierarchy mapping and is applied on routes (app/routes.py) to restrict operations such as creating teams, API keys, webhooks, and usage analytics.

### Session & Audit Touchpoints
- get_current_user updates user.last_login and commits through the DB session (app/dependencies.py).
- API key verification updates APIKey.last_used_at for auditability (app/dependencies.py).
- Request timing middleware in main.py logs request/response timings and exposes X-Process-Time; these logs feed usage and analytics workflows.

### Webhooks & Signing
- Webhook creation and secrets are supported; webhooks include an X-Signature header using HMAC-SHA256 with the webhook secret (docs/api-reference.md). Timeouts and retry behavior are configurable in .env.example (WEBHOOK_TIMEOUT_SECONDS, WEBHOOK_MAX_RETRIES).

### Rate Limiting (Configuration)
- Subscription-tier limits are documented and configurable via environment variables: RATE_LIMIT_FREE, RATE_LIMIT_STARTER, RATE_LIMIT_PROFESSIONAL in .env.example.
- The API reference (docs/api-reference.md) lists the effective per-tier limits: Free=100 req/min, Starter=500 req/min, Professional=2000 req/min, Enterprise=Unlimited.

### Deployment & Secrets
- Production secret management guidance and recommended environment configuration are in docs/deployment.md and .env.example (SECRET_KEY, DATABASE_URL, CORS_ORIGINS, DEBUG). The README.md and deployment guide highlight enabling HTTPS, setting a strong SECRET_KEY, and restricting CORS origins.

Files:
- app/auth.py
- app/dependencies.py
- app/routes.py
- main.py
- .env.example
- docs/api-reference.md
- docs/deployment.md
- README.md

## Source Files
- app/auth.py
- app/dependencies.py
- app/routes.py
- main.py
- .env.example
- docs/api-reference.md
- docs/deployment.md
- README.md